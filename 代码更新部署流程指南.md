# ä»£ç æ›´æ–°éƒ¨ç½²æµç¨‹æŒ‡å— (å°ç™½ç‰ˆ)

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ ä»æœ¬åœ°å¼€å‘åˆ°æœåŠ¡å™¨éƒ¨ç½²çš„å®Œæ•´æµç¨‹ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰è¯¦ç»†è¯´æ˜ã€‚

## ğŸ“‹ å‰ç½®å‡†å¤‡

### 1. ç¡®ä¿æœ¬åœ°ç¯å¢ƒæ­£å¸¸
- ç¡®ä¿æœ¬åœ°é¡¹ç›®èƒ½æ­£å¸¸è¿è¡Œ (`npm run dev`)
- ç¡®ä¿ç™»å½•æ³¨å†ŒåŠŸèƒ½æ­£å¸¸
- ç¡®ä¿æ²¡æœ‰æŠ¥é”™

### 2. å‡†å¤‡Gitç¯å¢ƒ
å¦‚æœè¿˜æ²¡æœ‰é…ç½®Gitï¼Œè¯·å…ˆé…ç½®ï¼š
```bash
# é…ç½®ç”¨æˆ·ä¿¡æ¯ï¼ˆåªéœ€è¦é…ç½®ä¸€æ¬¡ï¼‰
git config --global user.name "ä½ çš„åå­—"
git config --global user.email "ä½ çš„é‚®ç®±"
```

## ğŸš€ å®Œæ•´éƒ¨ç½²æµç¨‹

### æ­¥éª¤1ï¼šæœ¬åœ°ä»£ç æäº¤

#### 1.1 æ£€æŸ¥ä»£ç çŠ¶æ€
```bash
# æŸ¥çœ‹å“ªäº›æ–‡ä»¶è¢«ä¿®æ”¹äº†
git status
```

#### 1.2 æ·»åŠ ä¿®æ”¹çš„æ–‡ä»¶
```bash
# æ·»åŠ æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶
git add .

# æˆ–è€…æ·»åŠ ç‰¹å®šæ–‡ä»¶
git add src/components/Login.tsx
git add vite.config.ts
```

#### 1.3 æäº¤ä»£ç 
```bash
# æäº¤ä»£ç å¹¶æ·»åŠ è¯´æ˜
git commit -m "ä¿®å¤ç™»å½•åŠŸèƒ½å’ŒAPIé…ç½®"

# è¯´æ˜è¦ç®€æ´æ˜äº†ï¼Œæè¿°ä½ åšäº†ä»€ä¹ˆä¿®æ”¹
```

#### 1.4 æ¨é€åˆ°è¿œç¨‹ä»“åº“
```bash
# æ¨é€åˆ°ä¸»åˆ†æ”¯
git push origin main

# å¦‚æœæ˜¯å…¶ä»–åˆ†æ”¯ï¼Œæ›¿æ¢mainä¸ºä½ çš„åˆ†æ”¯å
```

### æ­¥éª¤2ï¼šè¿æ¥æœåŠ¡å™¨

```bash
# è¿æ¥åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨
ssh root@139.196.228.41

# è¾“å…¥å¯†ç åè¿›å…¥æœåŠ¡å™¨
```

### æ­¥éª¤3ï¼šæœåŠ¡å™¨ç«¯æ›´æ–°ä»£ç 

#### 3.1 è¿›å…¥é¡¹ç›®ç›®å½•
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•ï¼ˆæ ¹æ®ä½ çš„å®é™…è·¯å¾„è°ƒæ•´ï¼‰
cd /root/çŸ­è§†é¢‘æ–‡æ¡ˆåŠ©æ‰‹

# æˆ–è€…
cd /var/www/video-script-helper
```

#### 3.2 æ‹‰å–æœ€æ–°ä»£ç 
```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# å¦‚æœæœ‰å†²çªï¼ŒæŒ‰æç¤ºè§£å†³
```

#### 3.3 å®‰è£…æ–°ä¾èµ–ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
```bash
# å®‰è£…å‰ç«¯ä¾èµ–
npm install

# å¦‚æœåç«¯æœ‰æ–°ä¾èµ–
cd api
npm install
cd ..
```

### æ­¥éª¤4ï¼šé‡æ–°æ„å»ºå‰ç«¯

```bash
# æ„å»ºå‰ç«¯é¡¹ç›®
npm run build

# ç­‰å¾…æ„å»ºå®Œæˆï¼Œç¡®ä¿æ²¡æœ‰é”™è¯¯
```

### æ­¥éª¤5ï¼šé‡å¯æœåŠ¡

#### 5.1 é‡å¯Nginx
```bash
# é‡å¯NginxæœåŠ¡
sudo systemctl restart nginx

# æ£€æŸ¥NginxçŠ¶æ€
sudo systemctl status nginx
```

#### 5.2 é‡å¯åç«¯APIæœåŠ¡

**æ–¹æ³•ä¸€ï¼šå¦‚æœä½¿ç”¨PM2ç®¡ç†**
```bash
# æŸ¥çœ‹PM2è¿›ç¨‹
pm2 list

# é‡å¯APIæœåŠ¡
pm2 restart video-script-api

# æŸ¥çœ‹æ—¥å¿—
pm2 logs video-script-api
```

**æ–¹æ³•äºŒï¼šå¦‚æœç›´æ¥è¿è¡ŒNode.js**
```bash
# æ‰¾åˆ°å¹¶åœæ­¢ç°æœ‰è¿›ç¨‹
ps aux | grep node
kill -9 [è¿›ç¨‹ID]

# é‡æ–°å¯åŠ¨APIæœåŠ¡
cd api
npm run start &
cd ..
```

### æ­¥éª¤6ï¼šéªŒè¯éƒ¨ç½²

#### 6.1 æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# æ£€æŸ¥NginxçŠ¶æ€
sudo systemctl status nginx

# æ£€æŸ¥APIæœåŠ¡æ˜¯å¦è¿è¡Œ
ps aux | grep node

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :3000
```

#### 6.2 æµ‹è¯•ç½‘ç«™åŠŸèƒ½
1. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://139.196.228.41`
2. æµ‹è¯•ç™»å½•åŠŸèƒ½
3. æµ‹è¯•æ³¨å†ŒåŠŸèƒ½
4. æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šgit pullå¤±è´¥
```bash
# å¦‚æœæœ‰æœ¬åœ°ä¿®æ”¹å†²çª
git stash  # æš‚å­˜æœ¬åœ°ä¿®æ”¹
git pull origin main
git stash pop  # æ¢å¤æœ¬åœ°ä¿®æ”¹
```

### é—®é¢˜2ï¼šnpm run buildå¤±è´¥
```bash
# æ¸…é™¤ç¼“å­˜é‡è¯•
npm cache clean --force
rm -rf node_modules
npm install
npm run build
```

### é—®é¢˜3ï¼šAPIæœåŠ¡å¯åŠ¨å¤±è´¥
```bash
# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
netstat -tlnp | grep :3000

# å¦‚æœè¢«å ç”¨ï¼Œæ€æ­»è¿›ç¨‹
kill -9 [è¿›ç¨‹ID]

# é‡æ–°å¯åŠ¨
cd api
npm run start
```

### é—®é¢˜4ï¼šNginxé…ç½®é—®é¢˜
```bash
# æµ‹è¯•Nginxé…ç½®
sudo nginx -t

# å¦‚æœé…ç½®æœ‰è¯¯ï¼Œç¼–è¾‘é…ç½®æ–‡ä»¶
sudo nano /etc/nginx/sites-available/default

# é‡æ–°åŠ è½½é…ç½®
sudo systemctl reload nginx
```

## ğŸ“ å¿«é€Ÿå‘½ä»¤æ¸…å•

### æœ¬åœ°æ“ä½œ
```bash
# 1. æ£€æŸ¥çŠ¶æ€
git status

# 2. æäº¤ä»£ç 
git add .
git commit -m "æè¿°ä¿®æ”¹å†…å®¹"
git push origin main
```

### æœåŠ¡å™¨æ“ä½œ
```bash
# 1. è¿æ¥æœåŠ¡å™¨
ssh root@139.196.228.41

# 2. æ›´æ–°ä»£ç 
cd /root/çŸ­è§†é¢‘æ–‡æ¡ˆåŠ©æ‰‹  # æ ¹æ®å®é™…è·¯å¾„è°ƒæ•´
git pull origin main

# 3. é‡æ–°æ„å»º
npm install
npm run build

# 4. é‡å¯æœåŠ¡
sudo systemctl restart nginx
pm2 restart video-script-api  # æˆ–å…¶ä»–é‡å¯æ–¹å¼

# 5. æ£€æŸ¥çŠ¶æ€
sudo systemctl status nginx
ps aux | grep node
```

## âš ï¸ é‡è¦æé†’

1. **å¤‡ä»½é‡è¦æ•°æ®**ï¼šéƒ¨ç½²å‰å»ºè®®å¤‡ä»½æ•°æ®åº“
2. **æµ‹è¯•ç¯å¢ƒ**ï¼šé‡è¦æ›´æ–°å»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
3. **å›æ»šå‡†å¤‡**ï¼šè®°å½•ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬çš„commit IDï¼Œä»¥ä¾¿å›æ»š
4. **ç›‘æ§æ—¥å¿—**ï¼šéƒ¨ç½²åå¯†åˆ‡å…³æ³¨é”™è¯¯æ—¥å¿—
5. **ç”¨æˆ·é€šçŸ¥**ï¼šå¦‚æœæ˜¯é‡å¤§æ›´æ–°ï¼Œæå‰é€šçŸ¥ç”¨æˆ·

## ğŸ†˜ ç´§æ€¥å›æ»š

å¦‚æœéƒ¨ç½²åå‘ç°ä¸¥é‡é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šï¼š

```bash
# 1. æŸ¥çœ‹æäº¤å†å²
git log --oneline

# 2. å›æ»šåˆ°ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬
git reset --hard [ä¸Šä¸€ä¸ªç¨³å®šçš„commit ID]

# 3. é‡æ–°æ„å»ºå’Œé‡å¯
npm run build
sudo systemctl restart nginx
pm2 restart video-script-api
```

---

**è®°ä½**ï¼šæ¯æ¬¡éƒ¨ç½²éƒ½è¦æŒ‰é¡ºåºæ‰§è¡Œï¼Œä¸è¦è·³è¿‡ä»»ä½•æ­¥éª¤ï¼å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå…ˆæŸ¥çœ‹æ—¥å¿—ï¼Œå†æ ¹æ®é”™è¯¯ä¿¡æ¯è§£å†³ã€‚